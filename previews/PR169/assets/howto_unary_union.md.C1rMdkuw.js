import{_ as s,c as a,o as n,a6 as e}from"./chunks/framework.CXV__M-i.js";const m=JSON.parse('{"title":"Unary union","description":"","frontmatter":{},"headers":[],"relativePath":"howto/unary_union.md","filePath":"howto/unary_union.md","lastUpdated":null}'),i={name:"howto/unary_union.md"},t=e(`<h1 id="Unary-union" tabindex="-1">Unary union <a class="header-anchor" href="#Unary-union" aria-label="Permalink to &quot;Unary union {#Unary-union}&quot;">â€‹</a></h1><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Makie, GeoMakie</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GeometryOps </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GO, GeoInterface </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GI</span></span></code></pre></div><p>Furst, we get the data. These are watersheds in Vancouver Island, Canada - the very same used in the GEOS benchmarks.</p><p>Since the file is zipped, we have to unzip it, which is why this code is a bit longer than it otherwise might be.</p><div class="language-@example vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">@example</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>wkt_gz_file = download(&quot;https://rawcdn.githack.com/pramsey/geos-performance/b54d92a678e2174059d1b0ff233e275e4bd02084/data/watersheds.wkt.gz&quot;, joinpath(tempdir(), &quot;watersheds.wkt.gz&quot;))</span></span>
<span class="line"><span>using GZip</span></span>
<span class="line"><span>handle = GZip.open(wkt_gz_file)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>using WellKnownGeometry, GeoFormatTypes</span></span>
<span class="line"><span>wkt = GeoFormatTypes.WellKnownText.((GeoFormatTypes.Geom(),), eachline(handle))</span></span>
<span class="line"><span>close(handle)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>geoms = GO.tuples(wkt)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>plot(geoms; color = 1:length(geoms), axis = (; aspect = DataAspect()))</span></span></code></pre></div><p>Now that we have the geometries, we reduce over the vector, performing unions along the way.</p><div class="language-@example vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">@example</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>@time final_multipoly = reduce(</span></span>
<span class="line"><span>    (x, y) -&gt; GO.union(x, y; target = GI.MultiPolygonTrait, fix = GO.UnionIntersectingPolygons()), </span></span>
<span class="line"><span>    GO.fix(geoms)</span></span>
<span class="line"><span>)</span></span></code></pre></div><div class="language-@example vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">@example</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>fixed_geoms = GO.buffer(geoms, 0)</span></span>
<span class="line"><span>@time final_multipoly = reduce(</span></span>
<span class="line"><span>    (x, y) -&gt; GO.union(x, y; target = GI.MultiPolygonTrait, fix = GO.UnionIntersectingPolygons()), </span></span>
<span class="line"><span>    fixed_geoms</span></span>
<span class="line"><span>)</span></span></code></pre></div><div class="language-@example vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">@example</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>@time GO.fix(GI.MultiPolygon(fixed_geoms); corrections = (GO.UnionIntersectingPolygons(),))</span></span></code></pre></div>`,9),p=[t];function l(o,c,h,r,d,g){return n(),a("div",null,p)}const k=s(i,[["render",l]]);export{m as __pageData,k as default};
